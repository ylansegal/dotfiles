#!/usr/bin/env bash
set -euo pipefail

# Link missing dotfiles so they are picked up form ~/.*

# Link dotfiles
ls ~/.dotfiles | \
  grep -v Brewfile | \
  grep -v LICENSE.txt | \
  grep -v README.md | \
  grep -v ylansegal.zsh-theme | \
  grep -v default-gems | \
  {
    while read rc_file; do
      if [ -e ~/.$rc_file ]; then
        echo "Skipping ~/.$rc_file, it already exists"
      else
        ln -s $HOME/.dotfiles/$rc_file $HOME/.$rc_file && echo "Linked ~/.$rc_file"
      fi
    done
  }

# Link oh-my-zsh theme
if [ -e $HOME/.oh-my-zsh/custom/themes/ylansegal.zsh-theme ]; then
  echo "Skipping ylansegal.zsh-theme, it already exists"
else
  mkdir -p $HOME/.oh-my-zsh/custom/themes
  ln -s $HOME/.dotfiles/ylansegal.zsh-theme $HOME/.oh-my-zsh/custom/themes/ylansegal.zsh-theme && \
    echo "Linked ylansegal.zsh-theme"
fi

# Link default-gems
if [ -e $(rbenv root)/default-gems ]; then
  echo "Skipping default-gems, it already exists"
else
  ln -s $HOME/.dotfiles/default-gems "$(rbenv root)/default-gems" && \
    echo "Linked default-gems"
fi
